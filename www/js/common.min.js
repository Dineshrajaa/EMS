function showWait(){$.mobile.loading("show",{text:"Please wait",textVisible:!0,theme:"b",textonly:!1,html:""})}function onResume(){for(var e=0;100>e;e++)console.log("Wait");localStorage.getItem("userSession")?redirect("Dashboard.html"):window.location.href="index.html"}function hideWait(){$.mobile.loading("hide")}function routing(e,t,a,r,s,n){window.location.href=e}function deleteLocalStorage(e){for(var t=0;t<e.length;t++)localStorage.removeItem(e[t])}function toast(e){new $.nd2Toast({message:e,action:{},ttl:3e3})}function logIn(e,t){if(e.length>0&&t.length>0){showWait();var a=serviceUrl+"Account/AuthenticateUser",r=new Object;r.username=e,r.password=t,r.isWebApp=!1,r.deviceId=localStorage.pushRegID||"",r.deviceTypeId="Android"==device.platform?2:1,$.ajax({type:"GET",url:a,data:r,async:!1,success:function(e){if(hideWait(),e.IsSuccessful){var t=JSON.stringify(e.Result);localStorage.setItem("userSession",t),toast("Sign In Successful")}else switch(e.MessageType){case 10:$("#statusMsg").addClass("(pending)"),$("#statusMsg").text("(Applicant login pending)");break;case 5:$("#statusMsg").addClass("(declined)"),$("#statusMsg").text("(Applicant login declined)");break;default:$("#statusMsg").text(""),toast("Incorrect username or pin")}},error:function(e){hideWait(),toast("Some Error Occoured.")}})}else 0===e.length?(toast("Please enter Username"),$("#txtUserName").focus()):0===t.length&&(toast("Please enter PIN"),$("#txtPassword").focus())}function doLogout(){localStorage.removeItem("userSession"),localStorage.removeItem("serviceUrl"),window.location.href="index.html",unsubscribePush()}function redirect(e){showWait(),window.location.href=e}function navigatePage(e){$(":mobile-pagecontainer").pagecontainer("change",e)}function GetAssignJob(){showWait();var e=localStorage.getItem("userSession"),t=JSON.parse(e),a=serviceUrl+"Account/GetJobAssignedByUserId",r=new Object;r.userId=t.ID,$.ajax({type:"GET",url:a,data:r,async:!1,success:function(e){if(e.IsSuccessful){if(e.Result){var t=e.Result;$("#spnCompany").html(t.BusinessName),$("#spnJobNumber").html(t.Number),$("#spnClient").html(t.Client),$("#spnProject").html(t.Location),$("#spnProjAddress").html(t.LocationAdress),$("#spnTrade").html(t.TradeClassification),$("#spnStartDate").html(t.StartDateStr),$("#spnMessage").html(t.Message),$("#spnDesc").html(t.Name),$("#spnContract").html(t.ContractType)}}else $("#currentJob").html(""),$("#currentJob").append("<h4>There are no current jobs</h4>")},error:function(e){hideWait(),toast("Network Error")}})}function GetAllAssignedPost(){showWait();var e=localStorage.getItem("userSession"),t=JSON.parse(e),a=serviceUrl+"Account/GetAssignedPostsByUserId",r=new Object;r.userId=t.ID,$.ajax({type:"GET",url:a,data:r,async:!1,success:function(e){hideWait()},error:function(e){hideWait(),toast("Network Error")}})}function GetPostDetailBy(e){showWait();var t=serviceUrl+"Account/GetPostById",a=new Object;a.postId=e,$.ajax({type:"GET",url:t,data:a,async:!1,success:function(e){hideWait()},error:function(e){hideWait(),toast("Network Error")}})}function fillProfilePicture(){var e=localStorage.getItem("userSession");if(e&&"undefined"!=e&&null!=e){e=JSON.parse(e),""!=e.ProfilePicture&&null!=e.ProfilePicture&&-1==e.ProfilePicture.indexOf("data:image/jpeg;base64,")&&(e.ProfilePicture="data:image/jpeg;base64,"+e.ProfilePicture);var t=""==e.ProfilePicture?"img/avtar.png":e.ProfilePicture;$("#imgUserImage").attr("src",t)}}function unsubscribePush(){var e=PushNotification.init({android:{senderID:"739681536553"},ios:{alert:"true",badge:"true",sound:"true"},windows:{}});e.unregister(function(){console.log("successfully unsubscribed")},function(){console.log("error")})}function convertUIDateToDb(e){var t=Date.parse(e);return"\\/Date("+t+")\\/"}function formatDate(e,t){var t=t||"-",a=new Date(e),r=a.getDate()<10?"0"+a.getDate():a.getDate(),s=parseInt(a.getMonth())+1,n=10>s?"0"+s:s,o=r+t+n+t+a.getFullYear();return o}function formatDateAndTime(e){var t=new Date(e),a=t.getDate()<10?"0"+t.getDate():t.getDate(),r=parseInt(t.getMonth())+1,s=10>r?"0"+r:r,n=parseInt(t.getHours()),o=parseInt(t.getMinutes()),i=a+"/"+s+"/"+t.getFullYear()+" "+n+":"+o;return i}function registerPush(){try{window.push=PushNotification.init({android:{senderID:"739681536553",forceShow:!0},ios:{alert:"true",badge:"true",sound:"true",clearBadge:"true"},windows:{}})}catch(e){jAlert(e)}window.push.on("registration",function(e){localStorage.pushRegID=e.registrationId}),window.push.on("notification",function(e){}),window.push.on("error",function(e){console.log("push error:"+e.message)})}function jAlert(e){var t=document.createElement("IFRAME");t.setAttribute("src",""),document.documentElement.appendChild(t),window.frames[0].window.alert(e),t.parentNode.removeChild(t),t=null}function getStatus(){var e=localStorage.getItem("userSession"),t=JSON.parse(e),a=serviceUrl+"Account/GetUserStatus",r={};r.id=parseInt(t.ID),showWait(),$.ajax({type:"GET",url:a,data:r,async:!1,success:function(e){e.IsSuccessful&&("1"==e.Result&&($(".statusButton,#divStatusChange").hide(),$("#curStatus").html("WORKING"),$("#curStatus").parent().removeClass("notAvailable").removeClass("available").removeClass("pending").addClass("working"),$("#currentJob,.finishJob").show()),"3"==e.Result?($("#curStatus").html("NOT AVAILABLE"),$("#curStatus").parent().removeClass("working").removeClass("available").removeClass("pending").addClass("notAvailable"),$(".checkToNA").hide(),$(".checkAvailable").show(),$("#divStatusChange").show(),$("#currentJob,.finishJob").hide()):($("#curStatus").html("AVAILABLE"),$("#curStatus").parent().removeClass("working").removeClass("notAvailable").removeClass("pending").addClass("available"),$(".checkToNA").show(),$(".checkAvailable").hide(),$("#divStatusChange").show(),$("#currentJob,.finishJob").hide())),hideWait()},error:function(e){hideWait(),toast("Network Error")}})}localStorage.serviceUrl=localStorage.serviceUrl||"http://52.63.234.33/EMSAPI/api/",localStorage.serviceUrl=localStorage.serviceUrl||"http://52.63.234.33/EMSAPI/api/";var serviceUrl=localStorage.serviceUrl;$(document).ajaxStart(function(){showWait()}),$(document).ajaxComplete(function(){hideWait()}),$(document).ajaxError(function(){hideWait()}),$(".panelBtn").on("click",function(){$("#profileDetailsPage,#avatarPage").unblock()}),$(document).bind("mobileinit",function(){$.extend($.mobile,{defaultPageTransition:"none"}),$.mobile.defaultPageTransition="none",$.mobile.defaultDialogTransition="none"}),document.addEventListener("resume",onResume,!1),$(document).ajaxStart(function(){showWait()}).ajaxStop(function(){hideWait()}),Date.prototype.getFormattedTime=function(){var e=0==this.getHours()?"12":this.getHours()>12?this.getHours()-12:this.getHours(),t=(this.getMinutes()<10?"0":"")+this.getMinutes(),a=this.getHours()<12?"AM":"PM",r=e+":"+t+" "+a;return r},Date.prototype.getFormattedDateInddMMYY=function(){var e=parseInt(parseInt(this.getMonth())+1)<10?"0"+parseInt(parseInt(this.getMonth())+1):parseInt(parseInt(this.getMonth())+1),t=parseInt(this.getDate())<10?"0"+this.getDate():this.getDate(),a=this.getFullYear();return t+"/"+e+"/"+a},$(document).on("pageinit","#profileDetailsPage,#avatarPage",function(){$("#cameraTypeList").on("panelclose",function(e,t){$("#profileDetailsPage,#avatarPage").unblock()})}),document.addEventListener("deviceready",function(){"iOS"==device.platform&&StatusBar.overlaysWebView(!1),StatusBar.backgroundColorByHexString("#0CACEB"),registerPush()},!0);