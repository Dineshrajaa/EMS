(function(){"use strict";var e,t,i,n=function(e,t){return function(){return e.apply(t,arguments)}};e=jQuery,t=function(){function e(){}return e.transitions={webkitTransition:"webkitTransitionEnd",mozTransition:"mozTransitionEnd",oTransition:"oTransitionEnd",transition:"transitionend"},e.transition=function(e){var t,i,n,r;t=e[0],r=this.transitions;for(n in r)if(i=r[n],null!=t.style[n])return i},e.execute=function(e,t){var i;return i=this.transition(e),null!=i?e.one(i,t):t()},e}(),i=function(){function i(t,r){null==r&&(r={}),this.show=n(this.show,this),this.hide=n(this.hide,this),this.toggle=n(this.toggle,this),this.keyup=n(this.keyup,this),this.align=n(this.align,this),this.resize=n(this.resize,this),this.process=n(this.process,this),this.href=n(this.href,this),this.type=n(this.type,this),this.image=n(this.image,this),this.prev=n(this.prev,this),this.next=n(this.next,this),this.close=n(this.close,this),this.$=n(this.$,this),this.$el=t,null!=this.$el.data("width")&&null!=this.$el.data("height")&&null==r.dimensions&&(r.dimensions={width:this.$el.data("width"),height:this.$el.data("height")}),this.settings=e.extend({},i.settings,r),this.$lighter=e(this.settings.template),this.$overlay=this.$(".lighter-overlay"),this.$content=this.$(".lighter-content"),this.$container=this.$(".lighter-container"),this.$close=this.$(".lighter-close"),this.$prev=this.$(".lighter-prev"),this.$next=this.$(".lighter-next"),this.$body=this.$(".lighter-body"),this.width=this.settings.dimensions.width,this.height=this.settings.dimensions.height,this.align(),this.process()}return i.settings={padding:40,dimensions:{width:960,height:540},template:"<div class='lighter fade'>\n  <div class='lighter-container'>\n    <span class='lighter-content'></span>\n    <a class='lighter-close'>&times;</a>\n    <a class='lighter-prev'>&lsaquo;</a>\n    <a class='lighter-next'>&rsaquo;</a>\n  </div>\n  <div class='lighter-overlay'></div>\n</div>"},i.lighter=function(e,t){var n;return null==t&&(t={}),n=e.data("_lighter"),n||(n=new i(e,t),e.data("_lighter",n)),n},i.prototype.$=function(e){return this.$lighter.find(e)},i.prototype.close=function(e){return null!=e&&e.preventDefault(),null!=e&&e.stopPropagation(),this.hide()},i.prototype.next=function(e){return null!=e&&e.preventDefault(),null!=e?e.stopPropagation():void 0},i.prototype.prev=function(){return"undefined"!=typeof event&&null!==event&&event.preventDefault(),"undefined"!=typeof event&&null!==event?event.stopPropagation():void 0},i.prototype.image=function(e){return e.match(/\.(jpeg|jpg|jpe|gif|png|bmp)$/i)},i.prototype.type=function(e){return null==e&&(e=this.href()),this.settings.type||(this.image(e)?"image":void 0)},i.prototype.href=function(){return this.$el.attr("href")},i.prototype.process=function(){var t,i,n,r=this;switch(n=this.type(t=this.href()),this.$content.html(function(){switch(n){case"image":return e("<img />").attr({src:t});default:return e(t)}}()),n){case"image":return i=new Image,i.src=t,i.onload=function(){return r.resize(i.width,i.height)}}},i.prototype.resize=function(e,t){return this.width=e,this.height=t,this.align()},i.prototype.align=function(){var t,i,n;return i=Math.max((t=this.height)/(e(window).height()-this.settings.padding),(n=this.width)/(e(window).width()-this.settings.padding)),i>1&&(t=Math.round(t/i)),i>1&&(n=Math.round(n/i)),this.$container.css({height:t,width:n,margin:"-"+t/2+"px -"+n/2+"px"})},i.prototype.keyup=function(e){return null==e.target.form?(27===e.which&&this.close(),37===e.which&&this.prev(),39===e.which?this.next():void 0):void 0},i.prototype.toggle=function(t){return null==t&&(t="on"),e(window)[t]("resize",this.align),e(document)[t]("keyup",this.keyup),this.$overlay[t]("click",this.close),this.$close[t]("click",this.close),this.$next[t]("click",this.next),this.$prev[t]("click",this.prev)},i.prototype.hide=function(){var e,i,n=this;return e=function(){return n.toggle("off")},i=function(){return n.$lighter.remove()},e(),this.$lighter.removeClass("fade"),this.$lighter.position(),this.$lighter.addClass("fade"),t.execute(this.$container,i)},i.prototype.show=function(){var i,n,r=this;return n=function(){return r.toggle("on")},i=function(){return e(document.body).append(r.$lighter)},i(),this.$lighter.addClass("fade"),this.$lighter.position(),this.$lighter.removeClass("fade"),t.execute(this.$container,n)},i}(),e.fn.extend({lighter:function(t){return null==t&&(t={}),this.each(function(){var n,r,a;return n=e(this),a=e.extend({},e.fn.lighter.defaults,"object"==typeof t&&t),r="string"==typeof t?t:t.action,null==r&&(r="show"),i.lighter(n,a)[r]()})}}),e(document).on("click","[data-lighter]",function(t){return t.preventDefault(),t.stopPropagation(),e(this).lighter()})}).call(this);