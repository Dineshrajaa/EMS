function timeToNowGMT(e) {
    var t = e
        , i = Number(t.match(/^(\d+)/)[1])
        , n = Number(t.match(/:(\d+)/)[1]);
    i >= 24 && (i -= 24);
    var r = i.toString()
        , a = n.toString();
    return 10 > i && (r = "0" + r), 10 > n && (a = "0" + a), r + ":" + a + ":00"
}

function saveLNPref() {
    if ("" == $("#txtTime").val()) return void toast("Please select the time for notification");
    if ("0" == $("#frequencySelect").val()) return void toast("Please choose the frequency of notification");
    var e = new Date
        , t = $("#txtTime").val()
        , i = ("0" + e.getDate()).slice(-2)
        , n = ("0" + (e.getMonth() + 1)).slice(-2)
        , r = e.getFullYear() + "-" + n + "-" + i + " " + t
        , a = new Date(r.replace(/-/g, "/")).getTime()
        , o = {};
    o.notificationTime = $("#txtTime").val(), o.frequency = $("#frequencySelect").val(), localStorage.savedLNPref = JSON.stringify(o), cordova.plugins.notification.local.on("click", function (e) {
        "iOS" == device.platform && cordova.plugins.notification.badge.clear()
    }), cordova.plugins.notification.local.schedule({
        text: "Please check that your work availability status is correct"
        , every: $("#frequencySelect").val()
        , at: new Date(a)
    }, function () {}), cordova.plugins.notification.local.on("schedule", function (e) {
        toast("Saved settings")
    })
}

function restoreLNPref() {
    if (void 0 != localStorage.savedLNPref && "" != localStorage.savedLNPref) {
        var e = JSON.parse(localStorage.savedLNPref);
        $("#statusCheck").attr("checked", !0).flipswitch().flipswitch("refresh"), $("#txtTime").val(e.notificationTime), $("#frequencySelect").val(e.frequency).selectmenu().selectmenu("refresh")
    }
    checkTestRole()
}

function checkTestRole() {
    var e = JSON.parse(localStorage.getItem("userSession"));
    e && "undefined" != e && "5" == e.RoleId && ($("#serviceChangerBlock").show(), "http://52.62.179.135/EMSAPI/api/" == serviceUrl ? ($("#serviceChanger").attr("checked", !0).flipswitch().flipswitch("refresh"), $("#serviceType").html("<b>Development</b>")) : "http://52.62.179.135/EMSAPI/api/" == serviceUrl && ($("#serviceChanger").attr("checked", !1).flipswitch().flipswitch("refresh"), $("#serviceType").html("<b>Production</b>")))
}
$("#statusCheck").change(function () {
    $(this).is(":checked") ? $("#statusBlock").show() : ($("#statusBlock").hide(), $("#txtTime").val(""), $("#frequencySelect").val(0).selectmenu().selectmenu("refresh"), localStorage.savedLNPref = "", cordova.plugins.notification.local.cancel(0, !1))
}), $("#serviceChanger").change(function () {
    var e = "Do you want to change to Development server?You will be logged out and settings will be saved.";
    $(this).is(":checked") ? navigator.notification.confirm(e, function (e) {
        1 == e && (localStorage.serviceUrl = "http://52.62.179.135/EMSAPI/api/", serviceUrl = "http://52.62.179.135/EMSAPI/api/", localStorage.removeItem("userSession"), window.location.href = "index.html")
    }) : (localStorage.serviceUrl = "http://52.62.179.135/EMSAPI/api/", serviceUrl = "http://52.62.179.135/EMSAPI/api/"), checkTestRole()
});